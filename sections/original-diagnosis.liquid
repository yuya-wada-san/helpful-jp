{% liquid
  comment initialized
  endcomment
  
%}

<section class="section--{{ section.id }}" id="section--{{ section.id }}">
  <div class="card-wrapper">
    <h3>What is your purpose?</h3>
    <div class="card-button-wrapper">
      <a>Contact</a>
      <a>Watching the profile</a>
    </div>
    <button class="button-close">Close</button>
  </div>
</section>


{% schema %}
{
  "name": "original diagnosis",
  "settings": [
    {
      "type": "color",
      "id": "bgColor",
      "label": "back ground color"
    },{
      "type": "text",
      "id": "margin",
      "label": "margin:"
    },{
      "type": "text",
      "id": "padding",
      "label": "padding:"
    }
  ],
  "presets": [
    {
      "name": "Original diagnosis"
    }
  ]
}
{% endschema %}

{% render 'style-original-diagnosis' %}

{% style %}
  .section--{{ section.id }} {
    margin: {{ section.settings.margin }};
    padding: {{ section.settings.padding }};
    background-color: rgba(0,0,0,0.5);
    position: fixed;
    top: 0;
    left: 0;
    z-index: 10;
    width: 100%;
    height: 100%;
  }
  .section--{{ section.id }} .card-wrapper {
    margin: 20vh auto;
    padding: 20px;
    border-radius: 5px;
    border: solid 1px #333;
    background-color: #EEE;
    width: 80vw;
    height: 50vh;
    max-width: 300px;
    max-height: 500px;
    display: flex;
    flex-direction: column;
  }
  .section--{{ section.id }} .card-wrapper .card-button-wrapper {
    margin-top: auto;
    margin-bottom: auto;
  }
  .section--{{ section.id }} .card-wrapper a {
    display: block;
    padding: 5px 5px 5px 10px;
    border-radius: 5px;
    background-color: #333;
    color: #EEE;
    margin-bottom: 10px;
    cursor: pointer;
  }
  .section--{{ section.id }} .card-wrapper button {
    display: block;
    margin: auto auto 0;
  }
{% endstyle %}

<script>
  $(function() {
    const $cardWrapper = $('.section--{{ section.id }}');
    const CloseModal = () => {
      $cardWrapper.fadeOut();
    };

    {% comment %} Click outside modal {% endcomment %}
    $(document).on('click', function(e) {
      if (!$(e.target).closest('.card-wrapper').length) {
        CloseModal();
      }
    });

    {% comment %} Click close button {% endcomment %}
    $('.button-close').on('click', function(){
      CloseModal();
    });
  });
</script>
